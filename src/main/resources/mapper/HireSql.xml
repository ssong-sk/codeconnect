<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.code.mapper.HireMapperInter">

<insert id="hireInsert" parameterType="hdto">
	insert into hire value(null, #{h_c_num}, #{h_ci_num}, #{h_category}, #{h_job}, #{h_tech}, 
	#{h_career}, #{h_grade}, #{h_location}, #{h_title}, #{h_subject}, #{h_major}, #{h_require}, 
	#{h_preference}, #{h_benefit}, #{h_process}, #{h_salary}, #{h_c_id}, #{h_deadline},now(),0)
</insert>

<select id="getHireList" resultType="hdto">
   SELECT h.*, c.c_name, ci.ci_image FROM hire h
   JOIN company c ON h.h_c_num = c.c_num 
   JOIN company_intro ci ON h.h_ci_num = ci.ci_num
</select>

<select id="searchHire" parameterType="map" resultType="hdto">
    SELECT h.*, c.c_name, ci.ci_image 
    FROM hire h
    JOIN company c ON h.h_c_num = c.c_num 
    JOIN company_intro ci ON h.h_ci_num = ci.ci_num 
    <where>
        <if test="search_job != null and search_job != ''">
            AND h.h_job REGEXP #{search_job}
        </if>
        <if test="search_tech != null and search_tech != ''">
            AND h.h_tech REGEXP #{search_tech}
        </if>
        <if test="search_region != null and search_region != ''">
            AND h.h_location REGEXP #{search_region}
        </if>
        <if test="search_career != null and search_career != '' and search_career != '전체'">
            AND h.h_career REGEXP #{search_career}
        </if>
        <if test="search_cate != null and search_cate != ''">
            AND h.h_category REGEXP #{search_cate}
        </if>
    </where>
</select>

<select id="getHireData" parameterType="int" resultType="hdto">
	SELECT h.*, c.*, ci.* 
	FROM hire h
	JOIN company c ON h.h_c_num = c.c_num 
	JOIN company_intro ci ON h.h_ci_num = ci.ci_num
	where h.h_num = #{h_num}
</select>

<!-- 스크랩 -->
<insert id="scrapInsert" parameterType="hdto">
	insert into scrap values(null, #{h_num}, #{r_num})
</insert>

<delete id="scrapDelete" parameterType="map">
	delete from scrap where r_num = #{r_num} and h_num = #{h_num}
</delete>

<select id="getRnumById" parameterType="String" resultType="int">
	select r_num from register where r_id=#{r_id}
</select>


<!-- 채용공고 지원하기 창 -->
<select id="selectIruckseo" parameterType="int" resultType="IruckseoInsertDto">
	select * from personal where r_num=#{r_num}
</select>

<!-- 채용공고 이력서 갯수 -->
<select id="countIruckseo" parameterType="int">
	select count(*) from personal where r_num=#{r_num}
</select>
</mapper>